{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "Raw Market Data Input Schema",
  "description": "Schema for raw market data from Polygon WebSocket ingested by ECS service",
  "type": "object",
  "required": [
    "record_type",
    "symbol",
    "open",
    "high", 
    "low",
    "close",
    "volume",
    "timestamp",
    "interval",
    "source"
  ],
  "properties": {
    "record_type": {
      "type": "string",
      "enum": ["ohlcv"],
      "description": "Type of market data record"
    },
    "symbol": {
      "type": "string",
      "pattern": "^[A-Z]{1,10}$",
      "description": "Stock symbol (uppercase letters only)"
    },
    "open": {
      "type": "number",
      "minimum": 0,
      "description": "Opening price for the interval"
    },
    "high": {
      "type": "number", 
      "minimum": 0,
      "description": "Highest price for the interval"
    },
    "low": {
      "type": "number",
      "minimum": 0, 
      "description": "Lowest price for the interval"
    },
    "close": {
      "type": "number",
      "minimum": 0,
      "description": "Closing price for the interval"
    },
    "volume": {
      "type": "integer",
      "minimum": 0,
      "description": "Trading volume for the interval"
    },
    "timestamp": {
      "type": "string",
      "format": "date-time",
      "description": "ISO 8601 timestamp of the data point"
    },
    "interval": {
      "type": "string",
      "enum": ["1m", "5m", "15m", "30m", "1h", "2h", "4h"],
      "description": "Time interval of the OHLCV data"
    },
    "source": {
      "type": "string",
      "enum": ["polygon_websocket_am", "polygon_rest_api", "manual"],
      "description": "Data source identifier"
    },
    "ingestion_time": {
      "type": "string",
      "format": "date-time",
      "description": "When the data was ingested into the system"
    }
  },
  "additionalProperties": false,
  "examples": [
    {
      "record_type": "ohlcv",
      "symbol": "AAPL",
      "open": 150.25,
      "high": 152.80,
      "low": 149.90,
      "close": 151.75,
      "volume": 1245600,
      "timestamp": "2024-01-15T15:30:00.000Z",
      "interval": "1m",
      "source": "polygon_websocket_am",
      "ingestion_time": "2024-01-15T15:30:01.245Z"
    }
  ]
}
