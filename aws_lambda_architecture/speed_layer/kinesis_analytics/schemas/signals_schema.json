{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "Trading Signals Schema",
  "description": "Schema for trading signals generated by Kinesis Analytics signal detection",
  "type": "object",
  "required": [
    "symbol",
    "signal_type",
    "signal_strength",
    "trigger_price",
    "signal_timestamp"
  ],
  "properties": {
    "symbol": {
      "type": "string",
      "pattern": "^[A-Z]{1,10}$",
      "description": "Stock symbol that generated the signal"
    },
    "signal_type": {
      "type": "string",
      "enum": [
        "vegas_breakout_long",
        "vegas_breakout_short", 
        "vegas_support",
        "vegas_resistance",
        "rsi_oversold",
        "rsi_overbought",
        "macd_bullish_crossover",
        "macd_bearish_crossover",
        "volume_spike",
        "price_breakout"
      ],
      "description": "Type of trading signal detected"
    },
    "signal_strength": {
      "type": "number",
      "minimum": 0.0,
      "maximum": 1.0,
      "description": "Confidence score for the signal (0.0 to 1.0)"
    },
    "trigger_price": {
      "type": "number",
      "minimum": 0,
      "description": "Price level that triggered the signal"
    },
    "signal_timestamp": {
      "type": "string",
      "format": "date-time",
      "description": "When the signal was generated"
    },
    "window_start": {
      "type": "string",
      "format": "date-time",
      "description": "Start of the analysis window"
    },
    "window_end": {
      "type": "string",
      "format": "date-time",
      "description": "End of the analysis window" 
    },
    "timeframe": {
      "type": "string",
      "enum": ["1m", "5m", "15m", "30m", "1h", "2h", "4h"],
      "description": "Timeframe used for signal analysis"
    },
    "indicators": {
      "type": "object",
      "description": "Technical indicator values at signal generation",
      "properties": {
        "ema_12": {
          "type": "number",
          "description": "12-period Exponential Moving Average"
        },
        "ema_144": {
          "type": "number", 
          "description": "144-period Exponential Moving Average"
        },
        "rsi": {
          "type": "number",
          "minimum": 0,
          "maximum": 100,
          "description": "Relative Strength Index"
        },
        "macd_line": {
          "type": "number",
          "description": "MACD line value"
        },
        "macd_signal": {
          "type": "number",
          "description": "MACD signal line value"
        },
        "volume_ratio": {
          "type": "number",
          "minimum": 0,
          "description": "Current volume vs average volume ratio"
        }
      },
      "additionalProperties": true
    },
    "metadata": {
      "type": "object",
      "description": "Additional signal context and parameters",
      "properties": {
        "channel_width": {
          "type": "number",
          "description": "Vegas Channel width as percentage"
        },
        "price_vs_vwap": {
          "type": "number",
          "description": "Price deviation from VWAP as percentage"
        },
        "volume_rank": {
          "type": "string",
          "enum": ["low", "normal", "above_avg", "high"],
          "description": "Volume classification"
        },
        "trend_direction": {
          "type": "string",
          "enum": ["bullish", "bearish", "sideways"],
          "description": "Overall trend direction"
        }
      },
      "additionalProperties": true
    },
    "expiry_time": {
      "type": "string",
      "format": "date-time",
      "description": "When this signal expires (for caching)"
    }
  },
  "additionalProperties": false,
  "examples": [
    {
      "symbol": "AAPL",
      "signal_type": "vegas_breakout_long",
      "signal_strength": 0.85,
      "trigger_price": 152.75,
      "signal_timestamp": "2024-01-15T15:30:00.000Z",
      "window_start": "2024-01-15T15:15:00.000Z",
      "window_end": "2024-01-15T15:30:00.000Z",
      "timeframe": "15m",
      "indicators": {
        "ema_12": 151.23,
        "ema_144": 149.85,
        "volume_ratio": 2.3
      },
      "metadata": {
        "channel_width": 0.92,
        "price_vs_vwap": 0.34,
        "volume_rank": "high",
        "trend_direction": "bullish"
      },
      "expiry_time": "2024-01-15T16:30:00.000Z"
    }
  ]
}
